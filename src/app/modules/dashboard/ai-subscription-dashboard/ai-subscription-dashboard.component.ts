import { Component, OnInit, SecurityContext } from '@angular/core';
import { DomSanitizer, SafeResourceUrl } from '@angular/platform-browser';

@Component({
  selector: 'app-ai-subscription-dashboard',
  templateUrl: './ai-subscription-dashboard.component.html',
  styleUrls: ['./ai-subscription-dashboard.component.scss']
})
export class AiSubscriptionDashboardComponent implements OnInit {
  loaded: boolean = false;
  urlSafe: SafeResourceUrl;
  url: string = "https://login.sellershub.io/aidashboard/app/dashboards#/view/e95e6110-9d6f-11ec-af01-2f4338321ea9?embed=true&_g=(filters:!(),refreshInterval:(pause:!f,value:10000),time:(from:now-5y,to:now))&_a=(description:'customersubscription%20dashboard',filters:!(),fullScreenMode:!f,options:(hidePanelTitles:!f,syncColors:!f,useMargins:!t),panels:!((embeddableConfig:(enhancements:(),hidePanelTitles:!t,savedVis:(data:(aggs:!(),searchSource:(filter:!(),query:(language:kuery,query:''))),description:'',id:'',params:(fontSize:12,markdown:'%23%23%23%20%5B!!%5BSellershub.io%5D(https:%2F%2Fwww.sellershub.io%2Fwp-content%2Fuploads%2F2021%2F11%2Fsel-up-1.png)%5D(https:%2F%2Fwww.sellershub.io%2F)%0A%0A%0A',openLinksInNewTab:!f),title:'',type:markdown,uiState:())),gridData:(h:6,i:eaac6e25-401e-4ab6-a750-797ecb256ff3,w:8,x:0,y:0),panelIndex:eaac6e25-401e-4ab6-a750-797ecb256ff3,type:visualization,version:'7.16.2'),(embeddableConfig:(enhancements:(),hidePanelTitles:!t,savedVis:(data:(aggs:!(),searchSource:(filter:!(),query:(language:kuery,query:''))),description:'',id:'',params:(fontSize:12,markdown:'%23%23%23%20User%20Subscription%20Data%0AThis%20dashboard%20contains%20User%20Subscription%20data%20for%20sales%20team%20to%20play%20with.%20You%20can%20view%20it,%20search%20it,%20and%20interact%20with%20the%20visualizations.%20For%20more%20information%20about%20Sellershub%20documentation,%20check%20our%20%5Bdocs%5D(https:%2F%2Fwww.sellershub.io%2Fknowledge-base%2Fuser-guide%2F).%20%20%20%20%20%20%20%0A',openLinksInNewTab:!f),title:'',type:markdown,uiState:())),gridData:(h:6,i:'14d8a456-77f9-496d-b0d1-4dee69c72b45',w:40,x:8,y:0),panelIndex:'14d8a456-77f9-496d-b0d1-4dee69c72b45',type:visualization,version:'7.16.2'),(embeddableConfig:(enhancements:(),hidePanelTitles:!f,savedVis:(data:(aggs:!(),searchSource:(filter:!(),query:(language:kuery,query:''))),description:'',id:'',params:(controls:!((fieldName:khub_user_id,id:'1648844487955',indexPattern:'111df770-9d6f-11ec-af01-2f4338321ea9',label:UserID,options:(dynamicOptions:!t,multiselect:!t,order:desc,size:50,type:terms),parent:'',type:list),(fieldName:item_name.keyword,id:'1648844521046',indexPattern:'111df770-9d6f-11ec-af01-2f4338321ea9',label:'Plan%20Name',options:(dynamicOptions:!f,multiselect:!t,order:desc,size:50,type:terms),parent:'',type:list),(fieldName:status.keyword,id:'1648845455365',indexPattern:'111df770-9d6f-11ec-af01-2f4338321ea9',label:Status,options:(dynamicOptions:!t,multiselect:!t,order:desc,size:5,type:terms),parent:'',type:list),(fieldName:order_limit,id:'1648844729955',indexPattern:'111df770-9d6f-11ec-af01-2f4338321ea9',label:'Order%20Limit',options:(decimalPlaces:0,step:1),parent:'',type:range)),pinFilters:!f,updateFiltersOnChange:!f,useTimeFilter:!f),title:'',type:input_control_vis,uiState:())),gridData:(h:8,i:'14cb7f30-4725-4951-bb78-4d6ea1e53128',w:48,x:0,y:6),panelIndex:'14cb7f30-4725-4951-bb78-4d6ea1e53128',title:'Subscription%20Filters',type:visualization,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-92fbd147-8bc1-45c5-aae3-852cd860fd10,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:('92fbd147-8bc1-45c5-aae3-852cd860fd10':(columnOrder:!(ac497fc8-471b-4b89-a97f-d183022f5482),columns:(ac497fc8-471b-4b89-a97f-d183022f5482:(customLabel:!t,dataType:number,isBucketed:!f,label:'%20',operationType:count,scale:ratio,sourceField:Records)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(accessor:ac497fc8-471b-4b89-a97f-d183022f5482,layerId:'92fbd147-8bc1-45c5-aae3-852cd860fd10',layerType:data)),title:'',type:lens,visualizationType:lnsMetric),enhancements:(),hidePanelTitles:!f),gridData:(h:4,i:b2939a85-1573-47d3-a885-c69aa6456010,w:9,x:0,y:14),panelIndex:b2939a85-1573-47d3-a885-c69aa6456010,title:'Subscription%20Count',type:lens,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-32de7fcd-ec21-41e8-933b-12a2204c8417,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:('32de7fcd-ec21-41e8-933b-12a2204c8417':(columnOrder:!(d2a537c5-b4b5-4661-be58-d2c4a65baa55),columns:(d2a537c5-b4b5-4661-be58-d2c4a65baa55:(customLabel:!t,dataType:number,isBucketed:!f,label:'%20',operationType:sum,scale:ratio,sourceField:order_limit)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(accessor:d2a537c5-b4b5-4661-be58-d2c4a65baa55,layerId:'32de7fcd-ec21-41e8-933b-12a2204c8417',layerType:data)),title:'',type:lens,visualizationType:lnsMetric),enhancements:(),hidePanelTitles:!f),gridData:(h:4,i:a808cfea-ba67-4377-8aa1-4d0ca09540d9,w:10,x:9,y:14),panelIndex:a808cfea-ba67-4377-8aa1-4d0ca09540d9,title:'Total%20Order%20Limit',type:lens,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-f59446bf-1379-4cc9-86cb-0e368f737888,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:(f59446bf-1379-4cc9-86cb-0e368f737888:(columnOrder:!(a1d9ed59-9f4d-4d01-aa23-dca7b0c8481b),columns:(a1d9ed59-9f4d-4d01-aa23-dca7b0c8481b:(customLabel:!t,dataType:number,isBucketed:!f,label:'%20',operationType:sum,scale:ratio,sourceField:channel_limit)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(accessor:a1d9ed59-9f4d-4d01-aa23-dca7b0c8481b,layerId:f59446bf-1379-4cc9-86cb-0e368f737888,layerType:data)),title:'',type:lens,visualizationType:lnsMetric),enhancements:(),hidePanelTitles:!f),gridData:(h:4,i:ae13ebd1-f32e-4a04-a8b9-39589613b25a,w:9,x:19,y:14),panelIndex:ae13ebd1-f32e-4a04-a8b9-39589613b25a,title:'Total%20Channel%20Limit',type:lens,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-b3cf93f1-01bf-4c78-998b-d533b5b6fe23,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:(b3cf93f1-01bf-4c78-998b-d533b5b6fe23:(columnOrder:!(fb10cf4d-37fc-44ba-b8e8-47288f2e3659),columns:(fb10cf4d-37fc-44ba-b8e8-47288f2e3659:(customLabel:!t,dataType:number,isBucketed:!f,label:'%20',operationType:sum,scale:ratio,sourceField:user_limit)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(accessor:fb10cf4d-37fc-44ba-b8e8-47288f2e3659,layerId:b3cf93f1-01bf-4c78-998b-d533b5b6fe23,layerType:data)),title:'',type:lens,visualizationType:lnsMetric),enhancements:(),hidePanelTitles:!f),gridData:(h:4,i:dde9f372-1483-467a-9838-852edc34f7d3,w:9,x:28,y:14),panelIndex:dde9f372-1483-467a-9838-852edc34f7d3,title:'Sum%20of%20User%20Limit',type:lens,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-0dccb852-ac59-4a87-aee5-e2859dc93d95,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:('0dccb852-ac59-4a87-aee5-e2859dc93d95':(columnOrder:!(e0098cb5-3430-4780-a17d-dd1469ba82f9),columns:(e0098cb5-3430-4780-a17d-dd1469ba82f9:(customLabel:!t,dataType:number,isBucketed:!f,label:'%20',operationType:sum,scale:ratio,sourceField:stock_limit)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(accessor:e0098cb5-3430-4780-a17d-dd1469ba82f9,layerId:'0dccb852-ac59-4a87-aee5-e2859dc93d95',layerType:data)),title:'',type:lens,visualizationType:lnsMetric),enhancements:(),hidePanelTitles:!f),gridData:(h:4,i:d02c981a-cb68-4bdb-b9a0-d6fe51ea6fa3,w:11,x:37,y:14),panelIndex:d02c981a-cb68-4bdb-b9a0-d6fe51ea6fa3,title:'Sum%20of%20Stock%20Limit',type:lens,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-19b99aac-5587-49e8-bf88-54e5b8eb9563,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:('19b99aac-5587-49e8-bf88-54e5b8eb9563':(columnOrder:!(e2278deb-94e9-48cc-8909-9957ce6e37ad,'9479d046-05cc-4638-ab86-96d9509d4d24',b1489448-0f91-4999-8438-b7efd38f253b),columns:('9479d046-05cc-4638-ab86-96d9509d4d24':(dataType:date,isBucketed:!t,label:'@timestamp',operationType:date_histogram,params:(interval:'1d'),scale:interval,sourceField:'@timestamp'),b1489448-0f91-4999-8438-b7efd38f253b:(dataType:number,isBucketed:!f,label:'Count%20of%20records',operationType:count,scale:ratio,sourceField:Records),e2278deb-94e9-48cc-8909-9957ce6e37ad:(dataType:string,isBucketed:!t,label:'Top%20values%20of%20item_name.keyword',operationType:terms,params:(missingBucket:!f,orderBy:(columnId:b1489448-0f91-4999-8438-b7efd38f253b,type:column),orderDirection:desc,otherBucket:!t,size:15),scale:ordinal,sourceField:item_name.keyword)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(axisTitlesVisibilitySettings:(x:!t,yLeft:!t,yRight:!t),fittingFunction:None,gridlinesVisibilitySettings:(x:!t,yLeft:!t,yRight:!t),labelsOrientation:(x:0,yLeft:0,yRight:0),layers:!((accessors:!(b1489448-0f91-4999-8438-b7efd38f253b),layerId:'19b99aac-5587-49e8-bf88-54e5b8eb9563',layerType:data,position:top,seriesType:bar_stacked,showGridlines:!f,splitAccessor:e2278deb-94e9-48cc-8909-9957ce6e37ad,xAccessor:'9479d046-05cc-4638-ab86-96d9509d4d24')),legend:(isVisible:!t,position:right),preferredSeriesType:bar_stacked,tickLabelsVisibilitySettings:(x:!t,yLeft:!t,yRight:!t),valueLabels:hide,yLeftExtent:(mode:full),yRightExtent:(mode:full))),title:'',type:lens,visualizationType:lnsXY),enhancements:(),hidePanelTitles:!f),gridData:(h:15,i:'0bc34f3e-b806-4d35-a2fa-0b952652b7ac',w:48,x:0,y:18),panelIndex:'0bc34f3e-b806-4d35-a2fa-0b952652b7ac',title:'Customer%20Subscriptions',type:lens,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-4294cdfc-ed6c-4900-8cf8-e1b877a1608f,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:('4294cdfc-ed6c-4900-8cf8-e1b877a1608f':(columnOrder:!('63d3c358-9628-4c6a-813a-6342a1282fea','0b8fab3c-245b-497e-b472-bf84d65dd3d4'),columns:('0b8fab3c-245b-497e-b472-bf84d65dd3d4':(dataType:number,isBucketed:!f,label:'Count%20of%20records',operationType:count,scale:ratio,sourceField:Records),'63d3c358-9628-4c6a-813a-6342a1282fea':(dataType:string,isBucketed:!t,label:'Top%20values%20of%20status.keyword',operationType:terms,params:(missingBucket:!f,orderBy:(columnId:'0b8fab3c-245b-497e-b472-bf84d65dd3d4',type:column),orderDirection:desc,otherBucket:!t,size:15),scale:ordinal,sourceField:status.keyword)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(layers:!((categoryDisplay:default,groups:!('63d3c358-9628-4c6a-813a-6342a1282fea'),layerId:'4294cdfc-ed6c-4900-8cf8-e1b877a1608f',layerType:data,legendDisplay:default,metric:'0b8fab3c-245b-497e-b472-bf84d65dd3d4',nestedLegend:!f,numberDisplay:percent)),shape:donut)),title:'',type:lens,visualizationType:lnsPie),enhancements:(),hidePanelTitles:!f),gridData:(h:14,i:'48bb4764-eef7-432b-8f3e-0bebfd2b4923',w:12,x:0,y:33),panelIndex:'48bb4764-eef7-432b-8f3e-0bebfd2b4923',title:'Status%20of%20Subscription',type:lens,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-a7d04ffd-68e2-47dd-961f-456f5b70c54e,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:(a7d04ffd-68e2-47dd-961f-456f5b70c54e:(columnOrder:!('23409acc-3c15-48d8-9c6b-80c1a8f82196','59ad4a8c-112e-4813-bbcd-b8a92baf8505'),columns:('23409acc-3c15-48d8-9c6b-80c1a8f82196':(dataType:string,isBucketed:!t,label:'Top%20values%20of%20item_name.keyword',operationType:terms,params:(missingBucket:!f,orderBy:(columnId:'59ad4a8c-112e-4813-bbcd-b8a92baf8505',type:column),orderDirection:desc,otherBucket:!t,size:15),scale:ordinal,sourceField:item_name.keyword),'59ad4a8c-112e-4813-bbcd-b8a92baf8505':(dataType:number,isBucketed:!f,label:'Count%20of%20records',operationType:count,scale:ratio,sourceField:Records)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(layers:!((categoryDisplay:default,groups:!('23409acc-3c15-48d8-9c6b-80c1a8f82196'),layerId:a7d04ffd-68e2-47dd-961f-456f5b70c54e,layerType:data,legendDisplay:default,metric:'59ad4a8c-112e-4813-bbcd-b8a92baf8505',nestedLegend:!f,numberDisplay:percent)),shape:donut)),title:'',type:lens,visualizationType:lnsPie),enhancements:(),hidePanelTitles:!f),gridData:(h:14,i:'8b09a27b-b282-4a57-95e1-f30ec2171bac',w:14,x:12,y:33),panelIndex:'8b09a27b-b282-4a57-95e1-f30ec2171bac',title:'Item%20of%20Subscription',type:lens,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-dd706e94-615c-427c-a363-fb9f2052b8c6,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:(dd706e94-615c-427c-a363-fb9f2052b8c6:(columnOrder:!('1237d82c-29e2-473b-8938-3bc7ae5e5be8','86d31c38-095d-444b-9961-901018b52f65'),columns:('1237d82c-29e2-473b-8938-3bc7ae5e5be8':(dataType:string,isBucketed:!t,label:'Top%20values%20of%20payment_processor.keyword',operationType:terms,params:(missingBucket:!f,orderBy:(columnId:'86d31c38-095d-444b-9961-901018b52f65',type:column),orderDirection:desc,otherBucket:!t,size:15),scale:ordinal,sourceField:payment_processor.keyword),'86d31c38-095d-444b-9961-901018b52f65':(dataType:number,isBucketed:!f,label:'Count%20of%20records',operationType:count,scale:ratio,sourceField:Records)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(layers:!((categoryDisplay:default,groups:!('1237d82c-29e2-473b-8938-3bc7ae5e5be8','1237d82c-29e2-473b-8938-3bc7ae5e5be8','1237d82c-29e2-473b-8938-3bc7ae5e5be8','1237d82c-29e2-473b-8938-3bc7ae5e5be8','1237d82c-29e2-473b-8938-3bc7ae5e5be8'),layerId:dd706e94-615c-427c-a363-fb9f2052b8c6,layerType:data,legendDisplay:default,metric:'86d31c38-095d-444b-9961-901018b52f65',nestedLegend:!f,numberDisplay:percent)),shape:donut)),title:'',type:lens,visualizationType:lnsPie),enhancements:(),hidePanelTitles:!f),gridData:(h:14,i:'58965596-492d-433c-9a66-cf9b81c85f3e',w:11,x:26,y:33),panelIndex:'58965596-492d-433c-9a66-cf9b81c85f3e',title:'Payment%20Processor',type:lens,version:'7.16.2'),(embeddableConfig:(attributes:(references:!((id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-current-indexpattern,type:index-pattern),(id:'111df770-9d6f-11ec-af01-2f4338321ea9',name:indexpattern-datasource-layer-9d8a7024-49d8-4a45-b493-9d42d45a8dbc,type:index-pattern)),state:(datasourceStates:(indexpattern:(layers:('9d8a7024-49d8-4a45-b493-9d42d45a8dbc':(columnOrder:!(a780b6ce-6c7b-42b9-9d49-e6613b7217a1,'8047f0f7-73ca-4089-b26f-9522edfc33c2'),columns:('8047f0f7-73ca-4089-b26f-9522edfc33c2':(dataType:number,isBucketed:!f,label:'Count%20of%20records',operationType:count,scale:ratio,sourceField:Records),a780b6ce-6c7b-42b9-9d49-e6613b7217a1:(dataType:string,isBucketed:!t,label:'Top%20values%20of%20cancelreason.keyword',operationType:terms,params:(missingBucket:!f,orderBy:(columnId:'8047f0f7-73ca-4089-b26f-9522edfc33c2',type:column),orderDirection:desc,otherBucket:!t,size:15),scale:ordinal,sourceField:cancelreason.keyword)),incompleteColumns:())))),filters:!(),query:(language:kuery,query:''),visualization:(layers:!((categoryDisplay:default,groups:!(a780b6ce-6c7b-42b9-9d49-e6613b7217a1),layerId:'9d8a7024-49d8-4a45-b493-9d42d45a8dbc',layerType:data,legendDisplay:default,metric:'8047f0f7-73ca-4089-b26f-9522edfc33c2',nestedLegend:!f,numberDisplay:percent)),shape:donut)),title:'',type:lens,visualizationType:lnsPie),enhancements:(),hidePanelTitles:!f),gridData:(h:14,i:'1ab4ac97-655e-422e-90d5-606909dcc378',w:11,x:37,y:33),panelIndex:'1ab4ac97-655e-422e-90d5-606909dcc378',title:'Subscription%20Cancel%20Reason',type:lens,version:'7.16.2'),(embeddableConfig:(enhancements:(),sort:!(!('@timestamp',desc))),gridData:(h:15,i:f7363c26-3dd7-42ef-a2a0-8eac0fb1a757,w:48,x:0,y:47),id:'981970b0-9c7a-11ec-af01-2f4338321ea9',panelIndex:f7363c26-3dd7-42ef-a2a0-8eac0fb1a757,type:search,version:'7.16.2')),query:(language:kuery,query:''),tags:!(),timeRestore:!f,title:customersubscription,viewMode:view)&show-query-input=true&show-time-filter=true&hide-filter-bar=true";
  constructor(public _sanitizer: DomSanitizer) {
    let userdetails = localStorage.getItem('userId');
    if (userdetails != null) {
      this.url = this.url.replace('(khub_user_id:2358)', '(khub_user_id:' + userdetails + ')');
      this.loaded = true;
      this.urlSafe = this._sanitizer.bypassSecurityTrustResourceUrl(this.url);
    }
  }

  ngOnInit(): void {

  }

  photoURL() {
    // return this._sanitizer.bypassSecurityTrustUrl(this.url);
    return this._sanitizer.sanitize(SecurityContext.URL, this.url)
  }


}
